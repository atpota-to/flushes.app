(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[716],{55405:function(e,n,t){Promise.resolve().then(t.bind(t,61202))},99376:function(e,n,t){"use strict";var o=t(35475);t.o(o,"useParams")&&t.d(n,{useParams:function(){return o.useParams}}),t.o(o,"usePathname")&&t.d(n,{usePathname:function(){return o.usePathname}}),t.o(o,"useRouter")&&t.d(n,{useRouter:function(){return o.useRouter}})},61202:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return u}});var o=t(57437),i=t(2265),s=t(99376),l=t(7766),r=t(17207),a=t.n(r);function u(){let e=(0,s.useRouter)(),{signIn:n}=(0,l.a)(),[t,r]=(0,i.useState)(""),[u,c]=(0,i.useState)(!1),[d,h]=(0,i.useState)(null),_=async e=>{if(e.preventDefault(),!t.trim()){h("Please enter your handle or DID");return}c(!0),h(null);try{console.log("Starting OAuth flow for: ".concat(t)),await n(t.trim()),console.log("This should not be logged - redirect should have occurred")}catch(e){console.error("Login error:",e),h(e.message||"Failed to start login process"),c(!1)}};return(0,o.jsx)("div",{className:a().container,children:(0,o.jsxs)("div",{className:a().loginBox,children:[(0,o.jsx)("h1",{className:a().title,children:"Sign in to Flushes"}),(0,o.jsx)("p",{className:a().subtitle,children:"Connect with your AT Protocol account"}),(0,o.jsxs)("form",{onSubmit:_,className:a().form,children:[(0,o.jsxs)("div",{className:a().inputGroup,children:[(0,o.jsx)("label",{htmlFor:"handle",className:a().label,children:"Handle or DID"}),(0,o.jsx)("input",{id:"handle",type:"text",value:t,onChange:e=>r(e.target.value),placeholder:"e.g., alice.bsky.social or did:plc:...",className:a().input,disabled:u,autoComplete:"username",autoFocus:!0}),(0,o.jsx)("p",{className:a().hint,children:"Enter your Bluesky handle, custom domain, or DID identifier"})]}),d&&(0,o.jsx)("div",{className:a().error,role:"alert",children:d}),(0,o.jsx)("button",{type:"submit",disabled:u||!t.trim(),className:a().submitButton,children:u?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:a().spinner}),"Connecting..."]}):"Sign In"})]}),(0,o.jsxs)("div",{className:a().info,children:[(0,o.jsx)("h3",{children:"Supported Services"}),(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:"Bluesky (bsky.social)"}),(0,o.jsx)("li",{children:"Custom domains (e.g., alice.example.com)"}),(0,o.jsx)("li",{children:"Third-party PDS servers"}),(0,o.jsx)("li",{children:"Self-hosted instances"})]})]}),(0,o.jsx)("div",{className:a().footer,children:(0,o.jsx)("button",{onClick:()=>e.push("/"),className:a().backButton,children:"â† Back to Home"})})]})})}},7766:function(e,n,t){"use strict";t.d(n,{AuthProvider:function(){return l},a:function(){return r}});var o=t(57437),i=t(2265);let s=(0,i.createContext)(void 0);function l(e){let{children:n}=e,[l,r]=(0,i.useState)(null),[a,u]=(0,i.useState)(!0),[c,d]=(0,i.useState)(!1);(0,i.useEffect)(()=>{d(!0)},[]),(0,i.useEffect)(()=>{c&&e();async function e(){try{u(!0);let{initializeOAuthClient:e}=await Promise.all([t.e(473),t.e(297),t.e(494)]).then(t.bind(t,62494)),n=await e();n&&(console.log("Initialized with existing session:",n.session.sub),r(n.session))}catch(e){console.error("Failed to initialize OAuth client:",e)}finally{u(!1)}}},[c]),(0,i.useEffect)(()=>{c&&e();async function e(){try{let{onSessionDeleted:e}=await Promise.all([t.e(473),t.e(297),t.e(494)]).then(t.bind(t,62494));e(e=>{let{sub:n,cause:t}=e;console.error("Session for ".concat(n," was invalidated:"),t),r(null)})}catch(e){console.error("Failed to set up session listener:",e)}}},[c]);let h=async e=>{if(!c)throw Error("Sign in can only be called on the client side");try{let{signIn:n}=await Promise.all([t.e(473),t.e(297),t.e(494)]).then(t.bind(t,62494));await n(e)}catch(e){throw console.error("Sign in failed:",e),e}},_=async()=>{if(!c)throw Error("Sign out can only be called on the client side");try{let{signOut:e}=await Promise.all([t.e(473),t.e(297),t.e(494)]).then(t.bind(t,62494));await e(),r(null)}catch(e){throw console.error("Sign out failed:",e),e}},g=async e=>{if(!c)throw Error("Restore session can only be called on the client side");try{let{restoreSession:n}=await Promise.all([t.e(473),t.e(297),t.e(494)]).then(t.bind(t,62494)),o=await n(e);return r(o),o}catch(e){throw console.error("Failed to restore session:",e),e}},m={session:l,isAuthenticated:!!l,isLoading:a||!c,signIn:h,signOut:_,restoreSession:g,accessToken:l?"available":null,refreshToken:l?"available":null,did:(null==l?void 0:l.sub)||null,handle:null,pdsEndpoint:null};return(0,o.jsx)(s.Provider,{value:m,children:n})}function r(){let e=(0,i.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},17207:function(e){e.exports={container:"login_container__5QAMw",loaderContainer:"login_loaderContainer__1CfGr",errorContainer:"login_errorContainer__wDDNb",loader:"login_loader__6SES9",spin:"login_spin__fKFA3",loginForm:"login_loginForm__ymvA1",subtitle:"login_subtitle__R_8JC",description:"login_description__W2Yw5",inputGroup:"login_inputGroup__uKxms",inputWithSuggestions:"login_inputWithSuggestions__88uW6",input:"login_input__OrWbz",suggestionsContainer:"login_suggestionsContainer__jSSVF",suggestionsList:"login_suggestionsList__AqDMZ",suggestionItem:"login_suggestionItem__8gx6R",suggestionButton:"login_suggestionButton__Ojfs3",avatar:"login_avatar__FQvoV",avatarPlaceholder:"login_avatarPlaceholder__15CKa",handle:"login_handle__5SeSW",noResults:"login_noResults__M2oEY",loadingContainer:"login_loadingContainer__O_Gn3",loadingDot:"login_loadingDot__iLTi3",dotPulse:"login_dotPulse__L4qxX",loginButton:"login_loginButton__gObYa",helpText:"login_helpText__NlX75",error:"login_error__fioO8",backButton:"login_backButton__czpHk"}}},function(e){e.O(0,[766,971,117,744],function(){return e(e.s=55405)}),_N_E=e.O()}]);