(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[716],{55405:function(e,n,t){Promise.resolve().then(t.bind(t,61202))},99376:function(e,n,t){"use strict";var i=t(35475);t.o(i,"useParams")&&t.d(n,{useParams:function(){return i.useParams}}),t.o(i,"usePathname")&&t.d(n,{usePathname:function(){return i.usePathname}}),t.o(i,"useRouter")&&t.d(n,{useRouter:function(){return i.useRouter}})},61202:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return c}});var i=t(57437),o=t(2265),s=t(99376),l=t(7766),r=t(17207),a=t.n(r);function c(){let e=(0,s.useRouter)(),{signIn:n}=(0,l.a)(),[t,r]=(0,o.useState)(""),[c,u]=(0,o.useState)(!1),[d,h]=(0,o.useState)(null),f=async e=>{if(e.preventDefault(),!t.trim()){h("Please enter your handle or DID");return}u(!0),h(null);try{console.log("Starting OAuth flow for: ".concat(t)),await n(t.trim()),console.log("This should not be logged - redirect should have occurred")}catch(e){console.error("Login error:",e),h(e.message||"Failed to start login process"),u(!1)}};return(0,i.jsx)("div",{className:a().container,children:(0,i.jsxs)("div",{className:a().loginBox,children:[(0,i.jsx)("h1",{className:a().title,children:"Sign in to Flushes"}),(0,i.jsx)("p",{className:a().subtitle,children:"Connect with your AT Protocol account"}),(0,i.jsxs)("form",{onSubmit:f,className:a().form,children:[(0,i.jsxs)("div",{className:a().inputGroup,children:[(0,i.jsx)("label",{htmlFor:"handle",className:a().label,children:"Handle or DID"}),(0,i.jsx)("input",{id:"handle",type:"text",value:t,onChange:e=>r(e.target.value),placeholder:"e.g., alice.bsky.social or did:plc:...",className:a().input,disabled:c,autoComplete:"username",autoFocus:!0}),(0,i.jsx)("p",{className:a().hint,children:"Enter your Bluesky handle, custom domain, or DID identifier"})]}),d&&(0,i.jsx)("div",{className:a().error,role:"alert",children:d}),(0,i.jsx)("button",{type:"submit",disabled:c||!t.trim(),className:a().submitButton,children:c?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:a().spinner}),"Connecting..."]}):"Sign In"})]}),(0,i.jsxs)("div",{className:a().info,children:[(0,i.jsx)("h3",{children:"Supported Services"}),(0,i.jsxs)("ul",{children:[(0,i.jsx)("li",{children:"Bluesky (bsky.social)"}),(0,i.jsx)("li",{children:"Custom domains (e.g., alice.example.com)"}),(0,i.jsx)("li",{children:"Third-party PDS servers"}),(0,i.jsx)("li",{children:"Self-hosted instances"})]})]}),(0,i.jsx)("div",{className:a().footer,children:(0,i.jsx)("button",{onClick:()=>e.push("/"),className:a().backButton,children:"â† Back to Home"})})]})})}},7766:function(e,n,t){"use strict";t.d(n,{AuthProvider:function(){return l},a:function(){return r}});var i=t(57437),o=t(2265);let s=(0,o.createContext)(void 0);function l(e){let{children:n}=e,[l,r]=(0,o.useState)(null),[a,c]=(0,o.useState)(!0),[u,d]=(0,o.useState)(!1);(0,o.useEffect)(()=>{d(!0)},[]),(0,o.useEffect)(()=>{u&&e();async function e(){try{c(!0);let{initializeOAuthClient:e}=await Promise.all([t.e(473),t.e(297),t.e(494)]).then(t.bind(t,62494)),n=await e();n&&(console.log("Initialized with existing session:",n.session.sub),r(n.session))}catch(e){console.error("Failed to initialize OAuth client:",e)}finally{c(!1)}}},[u]),(0,o.useEffect)(()=>{u&&e();async function e(){try{let{onSessionDeleted:e}=await Promise.all([t.e(473),t.e(297),t.e(494)]).then(t.bind(t,62494));e(e=>{let{sub:n,cause:t}=e;console.error("Session for ".concat(n," was invalidated:"),t),r(null)})}catch(e){console.error("Failed to set up session listener:",e)}}},[u]);let h=async e=>{if(!u)throw Error("Sign in can only be called on the client side");try{let{signIn:n}=await Promise.all([t.e(473),t.e(297),t.e(494)]).then(t.bind(t,62494));await n(e)}catch(e){throw console.error("Sign in failed:",e),e}},f=async()=>{if(!u)throw Error("Sign out can only be called on the client side");try{let{signOut:e}=await Promise.all([t.e(473),t.e(297),t.e(494)]).then(t.bind(t,62494));await e(),r(null)}catch(e){throw console.error("Sign out failed:",e),e}},_=async e=>{if(!u)throw Error("Restore session can only be called on the client side");try{let{restoreSession:n}=await Promise.all([t.e(473),t.e(297),t.e(494)]).then(t.bind(t,62494)),i=await n(e);return r(i),i}catch(e){throw console.error("Failed to restore session:",e),e}},m={session:l,isAuthenticated:!!l,isLoading:a||!u,signIn:h,signOut:f,restoreSession:_,accessToken:l?"available":null,refreshToken:l?"available":null,did:(null==l?void 0:l.sub)||null,handle:null,pdsEndpoint:null};return(0,i.jsx)(s.Provider,{value:m,children:n})}function r(){let e=(0,o.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},17207:function(e){e.exports={container:"login_container__5QAMw",loginBox:"login_loginBox__yYGZo",title:"login_title__fKQ68",subtitle:"login_subtitle__R_8JC",form:"login_form__s7hSo",inputGroup:"login_inputGroup__uKxms",label:"login_label__w8FXq",input:"login_input__OrWbz",hint:"login_hint__MPwSK",error:"login_error__fioO8",submitButton:"login_submitButton__YqjiN",spinner:"login_spinner__C7thy",spin:"login_spin__fKFA3",info:"login_info__DsJ73",footer:"login_footer__b5aJR",backButton:"login_backButton__czpHk"}}},function(e){e.O(0,[766,971,117,744],function(){return e(e.s=55405)}),_N_E=e.O()}]);