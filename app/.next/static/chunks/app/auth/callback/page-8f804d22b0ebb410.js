(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[453],{35379:function(e,n,t){Promise.resolve().then(t.bind(t,49838))},99376:function(e,n,t){"use strict";var r=t(35475);t.o(r,"useParams")&&t.d(n,{useParams:function(){return r.useParams}}),t.o(r,"usePathname")&&t.d(n,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(n,{useRouter:function(){return r.useRouter}})},49838:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return d}});var r=t(57437),i=t(2265),o=t(99376),a=t(7766),s=t(16516),c=t.n(s);function l(){return(0,r.jsx)("div",{className:c().container,children:(0,r.jsxs)("div",{className:c().loaderContainer,children:[(0,r.jsx)("div",{className:c().loader}),(0,r.jsx)("p",{children:"Processing login..."})]})})}function u(){let e=(0,o.useRouter)(),{session:n,isLoading:t}=(0,a.a)(),[s,l]=(0,i.useState)(null),[u,d]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{if(u)return;let e=setTimeout(()=>{n||t||(console.error("OAuth callback processing timed out"),l("Login process timed out. Please try again."))},3e4);return()=>{clearTimeout(e),d(!0)}},[n,t,u]),(0,i.useEffect)(()=>{n&&!t&&(console.log("Successfully authenticated user: ".concat(n.sub)),setTimeout(()=>{e.push("/")},1e3))},[n,t,e]),(0,i.useEffect)(()=>{{let e=new URLSearchParams(window.location.search),n=e.get("error"),t=e.get("error_description");if(n){console.error("OAuth error in URL: ".concat(n," - ").concat(t)),l("Authentication error: ".concat(t||n));return}let r=new URLSearchParams(window.location.hash.substring(1)),i=r.get("error"),o=r.get("error_description");if(i){console.error("OAuth error in hash: ".concat(i," - ").concat(o)),l("Authentication error: ".concat(o||i));return}}if(!t&&!n){let e=setTimeout(()=>{n||(console.error("No session available after callback processing"),l("Failed to complete authentication. Please try again."))},5e3);return()=>clearTimeout(e)}},[t,n]),s)?(0,r.jsx)("div",{className:c().container,children:(0,r.jsxs)("div",{className:c().errorContainer,children:[(0,r.jsx)("h1",{children:"Authentication Error"}),(0,r.jsx)("p",{className:c().error,children:s}),(0,r.jsx)("button",{onClick:()=>e.push("/auth/login"),className:c().button,children:"Try Again"}),(0,r.jsx)("button",{onClick:()=>e.push("/"),className:c().button,children:"Back to Home"})]})}):n?(0,r.jsx)("div",{className:c().container,children:(0,r.jsxs)("div",{className:c().successContainer,children:[(0,r.jsx)("div",{className:c().checkmark,children:"âœ“"}),(0,r.jsx)("h1",{children:"Welcome back!"}),(0,r.jsx)("p",{children:"Successfully signed in! Redirecting..."}),(0,r.jsx)("p",{children:"Redirecting to home page..."})]})}):(0,r.jsx)("div",{className:c().container,children:(0,r.jsxs)("div",{className:c().loaderContainer,children:[(0,r.jsx)("div",{className:c().loader}),(0,r.jsx)("p",{children:"Completing authentication..."})]})})}function d(){return(0,r.jsx)(i.Suspense,{fallback:(0,r.jsx)(l,{}),children:(0,r.jsx)(u,{})})}},7766:function(e,n,t){"use strict";t.d(n,{AuthProvider:function(){return a},a:function(){return s}});var r=t(57437),i=t(2265);let o=(0,i.createContext)(void 0);function a(e){let{children:n}=e,[a,s]=(0,i.useState)(null),[c,l]=(0,i.useState)(!0),[u,d]=(0,i.useState)(!1);(0,i.useEffect)(()=>{d(!0)},[]),(0,i.useEffect)(()=>{u&&e();async function e(){try{l(!0);let{initializeOAuthClient:e}=await Promise.all([t.e(473),t.e(297),t.e(494)]).then(t.bind(t,62494)),n=await e();n&&(console.log("Initialized with existing session:",n.session.sub),s(n.session))}catch(e){console.error("Failed to initialize OAuth client:",e)}finally{l(!1)}}},[u]),(0,i.useEffect)(()=>{u&&e();async function e(){try{let{onSessionDeleted:e}=await Promise.all([t.e(473),t.e(297),t.e(494)]).then(t.bind(t,62494));e(e=>{let{sub:n,cause:t}=e;console.error("Session for ".concat(n," was invalidated:"),t),s(null)})}catch(e){console.error("Failed to set up session listener:",e)}}},[u]);let h=async e=>{if(!u)throw Error("Sign in can only be called on the client side");try{let{signIn:n}=await Promise.all([t.e(473),t.e(297),t.e(494)]).then(t.bind(t,62494));await n(e)}catch(e){throw console.error("Sign in failed:",e),e}},f=async()=>{if(!u)throw Error("Sign out can only be called on the client side");try{let{signOut:e}=await Promise.all([t.e(473),t.e(297),t.e(494)]).then(t.bind(t,62494));await e(),s(null)}catch(e){throw console.error("Sign out failed:",e),e}},m=async e=>{if(!u)throw Error("Restore session can only be called on the client side");try{let{restoreSession:n}=await Promise.all([t.e(473),t.e(297),t.e(494)]).then(t.bind(t,62494)),r=await n(e);return s(r),r}catch(e){throw console.error("Failed to restore session:",e),e}},b={session:a,isAuthenticated:!!a,isLoading:c||!u,signIn:h,signOut:f,restoreSession:m,accessToken:a?"available":null,refreshToken:a?"available":null,did:(null==a?void 0:a.sub)||null,handle:null,pdsEndpoint:null};return(0,r.jsx)(o.Provider,{value:b,children:n})}function s(){let e=(0,i.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},16516:function(e){e.exports={container:"callback_container__4mCQY",loaderContainer:"callback_loaderContainer__wEg9L",errorContainer:"callback_errorContainer__bRI_N",loader:"callback_loader__YVzJm",spin:"callback_spin__MJhVO",error:"callback_error__IlMhg",button:"callback_button__0diuj"}}},function(e){e.O(0,[655,971,117,744],function(){return e(e.s=35379)}),_N_E=e.O()}]);