(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{67105:function(e,t,n){Promise.resolve().then(n.bind(n,88291)),Promise.resolve().then(n.t.bind(n,2778,23)),Promise.resolve().then(n.bind(n,5165)),Promise.resolve().then(n.bind(n,74915)),Promise.resolve().then(n.bind(n,7766)),Promise.resolve().then(n.bind(n,76283))},5165:function(e,t,n){"use strict";n.d(t,{default:function(){return r}});var a=n(57437),s=n(2265);function r(e){let{children:t,fallback:n=null}=e,[r,i]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{i(!0)},[]),r)?(0,a.jsx)(a.Fragment,{children:t}):(0,a.jsx)(a.Fragment,{children:n})}},74915:function(e,t,n){"use strict";n.d(t,{default:function(){return y}});var a=n(57437),s=n(2265),r=n(27648),i=n(33145),o=n(99376),l=n(52457),c=n.n(l),u=n(78238),d=n.n(u);function h(){let[e,t]=(0,s.useState)(""),[n,r]=(0,s.useState)([]),[i,l]=(0,s.useState)(!1),[c,u]=(0,s.useState)(!1),[h,m]=(0,s.useState)("Search user @handle"),f=(0,s.useRef)(null),g=(0,s.useRef)(null),v=(0,o.useRouter)(),x=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=()=>{window.innerWidth,m("Search handle")};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,s.useEffect)(()=>{let e=e=>{var t;!f.current||f.current.contains(e.target)||(null===(t=g.current)||void 0===t?void 0:t.contains(e.target))||u(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,s.useEffect)(()=>{if(x.current&&clearTimeout(x.current),!e||e.length<2){r([]),u(!1);return}return x.current=setTimeout(async()=>{try{l(!0);let t=e.trim().startsWith("@")?e.trim().substring(1):e.trim(),n=await fetch("https://public.api.bsky.app/xrpc/app.bsky.actor.searchActorsTypeahead?q=".concat(encodeURIComponent(t),"&limit=5"));if(n.ok){let e=await n.json();e.actors&&Array.isArray(e.actors)&&(r(e.actors.map(e=>({did:e.did,handle:e.handle,displayName:e.displayName,avatar:e.avatar}))),u(!0))}else console.error("Failed to fetch suggestions:",await n.text())}catch(e){console.error("Error fetching suggestions:",e)}finally{l(!1)}},300),()=>{x.current&&clearTimeout(x.current)}},[e]);let _=e=>{v.push("/profile/".concat(e.handle)),u(!1),t("")};return(0,a.jsxs)("div",{className:d().searchContainer,children:[(0,a.jsxs)("form",{onSubmit:t=>{if(t.preventDefault(),e.trim()){let t=e.trim().startsWith("@")?e.trim().substring(1):e.trim();v.push("/profile/".concat(t)),u(!1)}},className:d().searchForm,children:[(0,a.jsx)("input",{ref:g,type:"text",value:e,onChange:e=>t(e.target.value),placeholder:h,className:"".concat(d().searchInput," font-regular"),"aria-label":"Search for a user profile"}),(0,a.jsx)("button",{type:"submit",className:"".concat(d().searchButton," font-medium"),children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"18",height:"18",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,a.jsx)("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})})]}),c&&(0,a.jsx)("div",{className:d().suggestionsContainer,ref:f,children:i?(0,a.jsxs)("div",{className:d().loadingContainer,children:[(0,a.jsx)("div",{className:d().loadingDot}),(0,a.jsx)("div",{className:d().loadingDot}),(0,a.jsx)("div",{className:d().loadingDot})]}):n.length>0?(0,a.jsx)("ul",{className:d().suggestionsList,children:n.map(e=>(0,a.jsx)("li",{className:d().suggestionItem,children:(0,a.jsxs)("button",{type:"button",className:d().suggestionButton,onClick:()=>_(e),children:[e.avatar?(0,a.jsx)("img",{src:e.avatar,alt:e.handle,className:d().avatar,width:28,height:28}):(0,a.jsx)("div",{className:d().avatarPlaceholder}),(0,a.jsx)("div",{className:d().suggestionInfo,children:(0,a.jsxs)("span",{className:"".concat(d().handle," font-medium"),children:["@",e.handle]})})]})},e.did))}):(0,a.jsx)("div",{className:d().noResults,children:"No results found"})})]})}var m=n(76283),f=n(77764),g=n.n(f);let v=()=>(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"5"}),(0,a.jsx)("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),(0,a.jsx)("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),(0,a.jsx)("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),(0,a.jsx)("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),(0,a.jsx)("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),(0,a.jsx)("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),(0,a.jsx)("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),(0,a.jsx)("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}),x=()=>(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,a.jsx)("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),_=()=>(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,a.jsx)("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),(0,a.jsx)("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]});function w(){let e;let[t,n]=(0,s.useState)(!1),[r,i]=(0,s.useState)("system");try{e=(0,m.F)()}catch(e){}return((0,s.useEffect)(()=>{n(!0),e&&i(e.theme)},[e]),t)?(0,a.jsxs)("button",{className:"".concat(g().themeToggle," font-medium"),onClick:()=>{e&&("light"===r?(e.setTheme("dark"),i("dark")):"dark"===r?(e.setTheme("system"),i("system")):(e.setTheme("light"),i("light")))},"aria-label":"Switch to ".concat("light"===r?"dark":"dark"===r?"system":"light"," theme"),children:["light"===r?(0,a.jsx)(v,{}):"dark"===r?(0,a.jsx)(x,{}):(0,a.jsx)(_,{}),(0,a.jsx)("span",{className:"".concat(g().themeLabel," font-medium"),children:"light"===r?"Lights On":"dark"===r?"Lights Off":"System Lights"})]}):(0,a.jsxs)("button",{className:"".concat(g().themeToggle," font-medium"),"aria-label":"Theme toggle",children:[(0,a.jsx)(v,{}),(0,a.jsx)("span",{className:"".concat(g().themeLabel," font-medium"),children:"Lights On"})]})}var j=n(7766);function y(){let e=(0,o.usePathname)(),{isAuthenticated:t,signOut:n,session:s}=(0,j.a)(),l=async()=>{await n()};return(0,a.jsxs)("nav",{className:c().navbar,children:[(0,a.jsxs)("div",{className:c().navStart,children:[(0,a.jsx)(r.default,{href:"/",className:c().logo,children:(0,a.jsx)(i.default,{src:"/flushes-logo-horizontal.png",alt:"Flushes Logo",width:200,height:53,priority:!0,className:c().logoImage})}),(0,a.jsxs)("div",{className:c().navLinks,children:[(0,a.jsx)(r.default,{href:"/",className:"".concat(c().navLink," font-medium ").concat("/"===e?c().active:""),children:"Feed"}),(0,a.jsx)(r.default,{href:"/stats",className:"".concat(c().navLink," font-medium ").concat("/stats"===e?c().active:""),children:"Stats"}),(0,a.jsx)(r.default,{href:"/shortcut",className:"".concat(c().navLink," font-medium ").concat("/shortcut"===e?c().active:""),children:"Shortcut"}),(0,a.jsx)(r.default,{href:"/about",className:"".concat(c().navLink," font-medium ").concat("/about"===e?c().active:""),children:"About"}),t&&null]})]}),(0,a.jsxs)("div",{className:c().secondRow,children:[(0,a.jsx)("div",{className:c().navSearch,children:(0,a.jsx)(h,{})}),(0,a.jsxs)("div",{className:c().navEnd,children:[(0,a.jsx)(w,{}),t?(0,a.jsx)("button",{onClick:l,className:"".concat(c().authButton," font-medium"),children:"Logout"}):(0,a.jsx)(r.default,{href:"/auth/login",className:"".concat(c().authButton," font-medium"),children:"Login"})]})]})]})}},7766:function(e,t,n){"use strict";n.d(t,{AuthProvider:function(){return i},a:function(){return o}});var a=n(57437),s=n(2265);let r=(0,s.createContext)(void 0);function i(e){let{children:t}=e,[i,o]=(0,s.useState)(null),[l,c]=(0,s.useState)(!0),[u,d]=(0,s.useState)(!1);(0,s.useEffect)(()=>{d(!0)},[]),(0,s.useEffect)(()=>{u&&e();async function e(){try{c(!0);let{initializeOAuthClient:e}=await Promise.all([n.e(473),n.e(297),n.e(494)]).then(n.bind(n,62494)),t=await e();t&&(console.log("Initialized with existing session:",t.session.sub),o(t.session))}catch(e){console.error("Failed to initialize OAuth client:",e)}finally{c(!1)}}},[u]),(0,s.useEffect)(()=>{u&&e();async function e(){try{let{onSessionDeleted:e}=await Promise.all([n.e(473),n.e(297),n.e(494)]).then(n.bind(n,62494));e(e=>{let{sub:t,cause:n}=e;console.error("Session for ".concat(t," was invalidated:"),n),o(null)})}catch(e){console.error("Failed to set up session listener:",e)}}},[u]);let h=async e=>{if(!u)throw Error("Sign in can only be called on the client side");try{let{signIn:t}=await Promise.all([n.e(473),n.e(297),n.e(494)]).then(n.bind(n,62494));await t(e)}catch(e){throw console.error("Sign in failed:",e),e}},m=async()=>{if(!u)throw Error("Sign out can only be called on the client side");try{let{signOut:e}=await Promise.all([n.e(473),n.e(297),n.e(494)]).then(n.bind(n,62494));await e(),o(null)}catch(e){throw console.error("Sign out failed:",e),e}},f=async e=>{if(!u)throw Error("Restore session can only be called on the client side");try{let{restoreSession:t}=await Promise.all([n.e(473),n.e(297),n.e(494)]).then(n.bind(n,62494)),a=await t(e);return o(a),a}catch(e){throw console.error("Failed to restore session:",e),e}},g={session:i,isAuthenticated:!!i,isLoading:l||!u,signIn:h,signOut:m,restoreSession:f,accessToken:i?"available":null,refreshToken:i?"available":null,did:(null==i?void 0:i.sub)||null,handle:null,pdsEndpoint:null};return(0,a.jsx)(r.Provider,{value:g,children:t})}function o(){let e=(0,s.useContext)(r);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},76283:function(e,t,n){"use strict";n.d(t,{F:function(){return l},ThemeProvider:function(){return o}});var a=n(57437),s=n(2265);let r={theme:"system",setTheme:()=>{}},i=(0,s.createContext)(r);function o(e){let{children:t}=e,[n,o]=(0,s.useState)("system"),[l,c]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{{let e=localStorage.getItem("theme");e&&o(e),c(!0)}},[]),(0,s.useEffect)(()=>{if(!l)return;localStorage.setItem("theme",n);let e=window.document.documentElement;if("system"===n){let t=window.matchMedia("(prefers-color-scheme: dark)").matches;e.removeAttribute("data-theme"),t?e.classList.add("dark"):e.classList.remove("dark")}else e.setAttribute("data-theme",n),"dark"===n?e.classList.add("dark"):e.classList.remove("dark")},[n,l]),(0,s.useEffect)(()=>{if(!l)return;let e=window.matchMedia("(prefers-color-scheme: dark)"),t=()=>{if("system"===n){let t=window.document.documentElement;e.matches?t.classList.add("dark"):t.classList.remove("dark")}};return e.addEventListener("change",t),()=>e.removeEventListener("change",t)},[n,l]),(0,a.jsx)(i.Provider,{value:l?{theme:n,setTheme:o}:r,children:t})}function l(){return(0,s.useContext)(i)}},2778:function(){},52457:function(e){e.exports={navbar:"NavigationBar_navbar___sCt7",navStart:"NavigationBar_navStart__5TUuk",navEnd:"NavigationBar_navEnd__nvGO6",navSearch:"NavigationBar_navSearch__zgfXx",secondRow:"NavigationBar_secondRow__OhkeH",logo:"NavigationBar_logo__vQNJd",logoImage:"NavigationBar_logoImage__iGztJ",navLinks:"NavigationBar_navLinks__omNwI",navLink:"NavigationBar_navLink__PLvAq",active:"NavigationBar_active__alj8w",authButton:"NavigationBar_authButton__cVaHE"}},78238:function(e){e.exports={searchContainer:"ProfileSearch_searchContainer__nkryP",searchForm:"ProfileSearch_searchForm__Rs543",searchInput:"ProfileSearch_searchInput__TJsTP",searchButton:"ProfileSearch_searchButton__AtwMw",suggestionsContainer:"ProfileSearch_suggestionsContainer__u1Ehi",suggestionsList:"ProfileSearch_suggestionsList__pCc7t",suggestionItem:"ProfileSearch_suggestionItem__M3kdV",suggestionButton:"ProfileSearch_suggestionButton__XgZKC",avatar:"ProfileSearch_avatar__mhRwa",avatarPlaceholder:"ProfileSearch_avatarPlaceholder__BnGoB",suggestionInfo:"ProfileSearch_suggestionInfo__iKQgP",displayName:"ProfileSearch_displayName__FGK0Y",handle:"ProfileSearch_handle__n7546",noResults:"ProfileSearch_noResults__dxeQv",loadingContainer:"ProfileSearch_loadingContainer__TSs7l",loadingDot:"ProfileSearch_loadingDot__hSDF_",dotPulse:"ProfileSearch_dotPulse__u_w4T"}},77764:function(e){e.exports={themeToggle:"ThemeToggle_themeToggle__4_hy9",themeLabel:"ThemeToggle_themeLabel__HmoV6"}}},function(e){e.O(0,[633,972,961,971,117,744],function(){return e(e.s=67105)}),_N_E=e.O()}]);