(()=>{var e={};e.id=740,e.ids=[740],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},15673:e=>{"use strict";e.exports=require("node:events")},88849:e=>{"use strict";e.exports=require("node:http")},22286:e=>{"use strict";e.exports=require("node:https")},47261:e=>{"use strict";e.exports=require("node:util")},97353:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>_,originalPathname:()=>h,pages:()=>c,routeModule:()=>u,tree:()=>d}),t(45209),t(20357),t(35866);var a=t(23191),r=t(88716),l=t(37922),n=t.n(l),i=t(95231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);t.d(s,o);let d=["",{children:["stats",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,45209)),"/Users/dame/Library/Mobile Documents/com~apple~CloudDocs/Software/flushes/app/src/app/stats/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,20357)),"/Users/dame/Library/Mobile Documents/com~apple~CloudDocs/Software/flushes/app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/dame/Library/Mobile Documents/com~apple~CloudDocs/Software/flushes/app/src/app/stats/page.tsx"],h="/stats/page",_={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/stats/page",pathname:"/stats",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},74228:(e,s,t)=>{Promise.resolve().then(t.bind(t,13728))},13728:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var a=t(10326),r=t(17577),l=t(90434),n=t(33313),i=t.n(n),o=t(99153);function d(){let{isAuthenticated:e,session:s,signOut:t}=(0,o.a)(),[n,d]=(0,r.useState)(null),[c,h]=(0,r.useState)(!0),[_,u]=(0,r.useState)(null),m=async()=>{try{h(!0),u(null);let e=Date.now(),s=`/api/bluesky/stats?_t=${e}`;console.log(`Fetching stats from ${s}`);let t=await fetch(s,{method:"GET",cache:"no-store",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!t.ok)throw Error(`Failed to fetch stats: ${t.status}`);let a=await t.json(),r=await Promise.all(a.leaderboard.map(async e=>{try{let s=await fetch(`https://plc.directory/${e.did}/data`);if(s.ok){let t=await s.json(),a=t.alsoKnownAs?.[0];if(a&&a.startsWith("at://")){let s=a.substring(5);return{...e,handle:s}}}}catch(s){console.error(`Failed to resolve handle for DID ${e.did}`,s)}return e}));d({...a,leaderboard:r})}catch(e){console.error("Error fetching stats:",e),u(e.message||"Failed to load stats")}finally{h(!1)}};return(0,a.jsxs)("div",{className:i().container,children:[(0,a.jsxs)("div",{className:i().statsHeader,children:[a.jsx("h2",{children:"Plumbing Stats \uD83E\uDEA0"}),a.jsx("p",{className:i().statsSubtitle,children:"Global statistics for the Flushes network"})]}),(0,a.jsxs)("div",{className:i().controls,children:[a.jsx("button",{onClick:()=>m(),className:i().refreshButton,disabled:c,children:c?"Loading...":"Refresh Stats"}),a.jsx(l.default,{href:"/",className:i().homeLink,children:"Back to Feed"})]}),_&&(0,a.jsxs)("div",{className:i().error,children:["Error: ",_]}),c?(0,a.jsxs)("div",{className:i().loadingContainer,children:[a.jsx("div",{className:i().loader}),a.jsx("p",{children:"Loading stats..."})]}):n?(0,a.jsxs)("div",{className:i().statsContent,children:[(0,a.jsxs)("section",{className:i().overallStats,children:[a.jsx("h2",{children:"Overall Flush Activity"}),a.jsx("a",{href:"https://bsky.app/profile/plumber.flushes.app",target:"_blank",rel:"noopener noreferrer",className:i().plumberProfileLink,children:"Follow our resident plumber on Bluesky"}),(0,a.jsxs)("div",{className:i().statsGrid,children:[(0,a.jsxs)("div",{className:i().statCard,children:[a.jsx("div",{className:i().statValue,children:n.totalCount}),a.jsx("div",{className:i().statLabel,children:"Total flushes"})]}),(0,a.jsxs)("div",{className:i().statCard,children:[a.jsx("div",{className:i().statValue,children:n.flushesPerDay}),a.jsx("div",{className:i().statLabel,children:"Flushes per day"})]}),(0,a.jsxs)("div",{className:i().statCard,children:[a.jsx("div",{className:i().statValue,children:n.plumberFlushCount}),a.jsx("div",{className:i().statLabel,children:"Plumber test flushes"})]}),(0,a.jsxs)("div",{className:i().statCard,children:[a.jsx("div",{className:i().statValue,children:n.totalFlushers}),a.jsx("div",{className:i().statLabel,children:"Total flushers"})]}),(0,a.jsxs)("div",{className:i().statCard,children:[a.jsx("div",{className:i().statValue,children:n.monthlyActiveFlushers}),a.jsx("div",{className:i().statLabel,children:"Monthly active flushers"})]}),(0,a.jsxs)("div",{className:i().statCard,children:[a.jsx("div",{className:i().statValue,children:n.dailyActiveFlushers}),a.jsx("div",{className:i().statLabel,children:"Daily active flushers (avg)"})]})]})]}),(0,a.jsxs)("section",{className:i().chartSection,children:[a.jsx("h2",{children:"Daily Activity"}),n.chartData.length>0?(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:i().chartContainer,children:n.chartData.map((e,s)=>{let t=Math.max(...n.chartData.map(e=>e.count)),r=Math.max(10,Math.min(100,e.count/t*100));return a.jsx("div",{className:i().chartBar,style:{height:`${r}%`},title:`${e.date}: ${e.count} flushes`},s)})}),(0,a.jsxs)("div",{className:i().chartLegend,children:[a.jsx("span",{className:i().chartLegendItem,children:n.chartData.length>0?new Date(n.chartData[0].date).toLocaleDateString(void 0,{month:"short",day:"numeric"}):""}),a.jsx("span",{className:i().chartLegendItem,children:n.chartData.length>0?new Date(n.chartData[n.chartData.length-1].date).toLocaleDateString(void 0,{month:"short",day:"numeric"}):""})]})]}):a.jsx("p",{className:i().noDataMessage,children:"Not enough data to display activity chart"})]}),(0,a.jsxs)("section",{className:i().leaderboardSection,children:[a.jsx("h2",{children:"Top Flushers"}),n.leaderboard.length>0?(0,a.jsxs)("div",{className:i().leaderboard,children:[(0,a.jsxs)("div",{className:i().leaderboardHeader,children:[a.jsx("span",{className:i().rank,children:"Rank"}),a.jsx("span",{className:i().user,children:"User"}),a.jsx("span",{className:i().count,children:"Flushes"})]}),n.leaderboard.map((e,s)=>{let t="";return 0===s?t=i().topRank:1===s?t=i().secondRank:2===s&&(t=i().thirdRank),(0,a.jsxs)("div",{className:`${i().leaderboardItem} ${t}`,children:[(0,a.jsxs)("span",{className:i().rank,children:["#",s+1]}),a.jsx("span",{className:i().user,children:e.handle?(0,a.jsxs)(l.default,{href:`/profile/${e.handle}`,title:`@${e.handle}`,children:["@",e.handle]}):(0,a.jsxs)("span",{className:i().unknownUser,children:[e.did.substring(0,10),"..."]})}),a.jsx("span",{className:i().count,children:e.count})]},s)})]}):a.jsx("p",{className:i().noDataMessage,children:"No leaderboard data available"})]}),(0,a.jsxs)("section",{className:i().emojiSection,children:[a.jsx("h2",{children:"Emoji Usage"}),n.emojiStats&&n.emojiStats.length>0?a.jsx("div",{className:i().emojiGrid,children:n.emojiStats.map((e,s)=>(0,a.jsxs)("div",{className:i().emojiCard,children:[a.jsx("div",{className:i().emoji,children:e.emoji}),a.jsx("div",{className:i().emojiCount,children:e.count})]},s))}):a.jsx("p",{className:i().noDataMessage,children:"No emoji data available"})]}),a.jsx("div",{className:i().shareSection,children:a.jsx("button",{className:i().shareButton,onClick:()=>{let e=`There have been ${n.totalCount} flushes by ${n.totalFlushers} unique users on @flushes.app! We have ${n.monthlyActiveFlushers} monthly active flushers and ${n.dailyActiveFlushers} daily active flushers on average. Check out the stats: https://flushes.app/stats`;window.open(`https://bsky.app/intent/compose?text=${encodeURIComponent(e)}`,"_blank")},children:"Share These Stats"})})]}):a.jsx("div",{className:i().emptyState,children:a.jsx("p",{children:"No stats data available"})})]})}},33313:e=>{e.exports={container:"stats_container__0HsAQ",header:"stats_header__9sD9c",headerContent:"stats_headerContent__M9_Sh",title:"stats_title__g_yzk",subtitle:"stats_subtitle__n40rI",description:"stats_description__HSsSv",creditLine:"stats_creditLine__WpGGS",kofiLink:"stats_kofiLink__jp7YY",headerActions:"stats_headerActions__CWiBy",userInfo:"stats_userInfo__bgXa_",logoutButton:"stats_logoutButton__tseaR",loginButton:"stats_loginButton___mXY5",statsHeader:"stats_statsHeader__BS5J0",statsSubtitle:"stats_statsSubtitle__bqiRY",controls:"stats_controls__Uojja",refreshButton:"stats_refreshButton__Zlv63",homeLink:"stats_homeLink__1iuoe",loadingContainer:"stats_loadingContainer__AzFmD",loader:"stats_loader__52AJY",spin:"stats_spin__rG0vl",error:"stats_error__8vXRU",emptyState:"stats_emptyState__S037y",statsContent:"stats_statsContent__q_dOi",overallStats:"stats_overallStats__cOcCy",chartSection:"stats_chartSection__srieH",leaderboardSection:"stats_leaderboardSection__lveop",emojiSection:"stats_emojiSection__JN76r",plumberProfileLink:"stats_plumberProfileLink__TcMfD",statsGrid:"stats_statsGrid__GCL_G",statCard:"stats_statCard__kfTN5",statValue:"stats_statValue__Os2uC",statLabel:"stats_statLabel___eg66",plumberLink:"stats_plumberLink__rKwK_",chartContainer:"stats_chartContainer__LFQal",chartBar:"stats_chartBar__P3BbP",chartLegend:"stats_chartLegend__VMRCe",noDataMessage:"stats_noDataMessage__EcQsv",leaderboard:"stats_leaderboard__qPOCc",leaderboardHeader:"stats_leaderboardHeader__UGY6K",leaderboardItem:"stats_leaderboardItem__oiP4Z",topRank:"stats_topRank__hdT1W",secondRank:"stats_secondRank__y2__D",thirdRank:"stats_thirdRank__QO5Fz",rank:"stats_rank__dWi9x",user:"stats_user__efntK",unknownUser:"stats_unknownUser__pMz0J",count:"stats_count__1X9Jf",emojiGrid:"stats_emojiGrid__VvPLY",emojiCard:"stats_emojiCard__xNwtu",emoji:"stats_emoji__XgGWx",emojiCount:"stats_emojiCount__ggkr6",shareSection:"stats_shareSection__QxdSk",shareButton:"stats_shareButton__Ms2N_"}},45209:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`/Users/dame/Library/Mobile Documents/com~apple~CloudDocs/Software/flushes/app/src/app/stats/page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[276,32,568],()=>t(97353));module.exports=a})();