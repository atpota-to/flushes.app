(()=>{var e={};e.id=702,e.ids=[702],e.modules={14569:e=>{"use strict";e.exports=require("@atproto/api")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},15673:e=>{"use strict";e.exports=require("node:events")},88849:e=>{"use strict";e.exports=require("node:http")},22286:e=>{"use strict";e.exports=require("node:https")},47261:e=>{"use strict";e.exports=require("node:util")},50876:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>d.a,__next_app__:()=>h,originalPathname:()=>c,pages:()=>u,routeModule:()=>_,tree:()=>l}),s(38256),s(20357),s(35866);var a=s(23191),r=s(88716),o=s(37922),d=s.n(o),n=s(95231),i={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>n[e]);s.d(t,i);let l=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,38256)),"/Users/dame/Library/Mobile Documents/com~apple~CloudDocs/Software/flushes/app/src/app/dashboard/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,20357)),"/Users/dame/Library/Mobile Documents/com~apple~CloudDocs/Software/flushes/app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],u=["/Users/dame/Library/Mobile Documents/com~apple~CloudDocs/Software/flushes/app/src/app/dashboard/page.tsx"],c="/dashboard/page",h={require:s,loadChunk:()=>Promise.resolve()},_=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},36688:(e,t,s)=>{Promise.resolve().then(s.bind(s,59530))},59530:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(10326),r=s(17577),o=s(35047),d=s(38853),n=s(47182),i=s.n(n);let l=["\uD83D\uDEBD","\uD83E\uDDFB","\uD83D\uDCA9","\uD83D\uDCA8","\uD83D\uDEBE","\uD83E\uDDFC","\uD83E\uDEA0","\uD83D\uDEBB","\uD83E\uDE78","\uD83D\uDCA7","\uD83D\uDCA6","\uD83D\uDE0C","\uD83D\uDE23","\uD83E\uDD22","\uD83E\uDD2E","\uD83E\uDD74","\uD83D\uDE2E‍\uD83D\uDCA8","\uD83D\uDE33","\uD83D\uDE35","\uD83C\uDF3E","\uD83C\uDF66","\uD83D\uDCF1","\uD83D\uDCD6","\uD83D\uDCAD","1️⃣","2️⃣","\uD83D\uDFE1","\uD83D\uDFE4"];function u(){let e=(0,o.useRouter)(),{isAuthenticated:t,session:n,signOut:u}=(0,d.a)();n?.sub;let[c,h]=(0,r.useState)(""),[_,p]=(0,r.useState)(l[0]),[m,b]=(0,r.useState)(!1),[x,D]=(0,r.useState)(null),[f,g]=(0,r.useState)(null),[j,v]=(0,r.useState)(!1),[w,N]=(0,r.useState)([]),[C,E]=(0,r.useState)(!0),[y,B]=(0,r.useState)(null),[S,k]=(0,r.useState)(new Set),L=async(e=!1)=>{try{E(!0),B(null);let t=await fetch(e?"/api/bluesky/feed?refresh=true":"/api/bluesky/feed",{cache:"no-store",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(!t.ok)throw Error(`Failed to fetch feed: ${t.status}`);let s=await t.json();if(w.length>0){let e=new Set(w.map(e=>e.id)),t=s.entries.filter(t=>!e.has(t.id));t.length>0&&(k(new Set(t.map(e=>e.id))),setTimeout(()=>{k(new Set)},2e3))}N(s.entries)}catch(e){console.error("Error fetching feed:",e),B(e.message||"Failed to load feed")}finally{E(!1)}},F=async()=>{await u(),e.push("/")},P=e=>{p(e)},A=async e=>{if(e.preventDefault(),!n||!t){D("Please sign in to post a flush");return}b(!0),D(null),g(null);try{let{createPost:e}=await s.e(2).then(s.bind(s,73002)),t=await e(n,{text:`is ${c||"flushing"} ${_}`,langs:["en"]});console.log("Status update result:",t),h(""),g("Your flushing status has been updated!"),setTimeout(()=>{v(!1)},2e3),setTimeout(()=>{L(!0)},1e3)}catch(e){console.error("Failed to update status:",e),D(`Failed to update status: ${e.message||"Unknown error"}`)}finally{b(!1)}};return t?(0,a.jsxs)("div",{className:i().container,children:[(0,a.jsxs)("header",{className:i().header,children:[a.jsx("h1",{children:"I'm Flushing"}),(0,a.jsxs)("div",{className:i().userInfo,children:[(0,a.jsxs)("span",{children:["Logged in as: @",null]}),(0,a.jsxs)("div",{className:i().actions,children:[a.jsx("button",{onClick:()=>L(!0),className:i().feedButton,children:"Refresh Feed"}),a.jsx("button",{onClick:F,className:i().logoutButton,children:"Logout"})]})]})]}),(0,a.jsxs)("button",{className:`${i().toggleButton} ${j?i().toggleButtonActive:""}`,onClick:()=>{v(!j),D(null),g(null)},children:[j?"Close":"Update Your Status",a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{d:"M19 9L12 16L5 9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]}),a.jsx("div",{className:`${i().statusUpdateContainer} ${j?i().statusUpdateOpen:""}`,children:(0,a.jsxs)("div",{className:i().card,children:[x&&a.jsx("div",{className:i().error,children:x}),f&&a.jsx("div",{className:i().success,children:f}),(0,a.jsxs)("form",{onSubmit:A,className:i().form,children:[(0,a.jsxs)("div",{className:i().formGroup,children:[a.jsx("label",{children:"Select an emoji for your status"}),a.jsx("div",{className:i().emojiGrid,children:l.map(e=>a.jsx("button",{type:"button",className:`${i().emojiButton} ${e===_?i().selectedEmoji:""}`,onClick:()=>P(e),disabled:m,children:e},e))})]}),(0,a.jsxs)("div",{className:i().formGroup,children:[a.jsx("label",{htmlFor:"status",children:"What's your status? (optional)"}),a.jsx("input",{type:"text",id:"status",value:c,onChange:e=>h(e.target.value),placeholder:"What's happening in the bathroom... (optional)",maxLength:60,className:i().input,disabled:m}),(0,a.jsxs)("div",{className:i().charCount,children:[c.length,"/60"]})]}),(0,a.jsxs)("div",{className:i().preview,children:[a.jsx("div",{className:i().previewTitle,children:"Preview:"}),(0,a.jsxs)("div",{className:i().previewContent,children:[a.jsx("span",{className:i().previewEmoji,children:_}),a.jsx("span",{children:c||"is flushing"})]})]}),a.jsx("button",{type:"submit",className:i().submitButton,disabled:m,children:m?"Updating...":"Update Status"})]})]})}),(0,a.jsxs)("div",{className:i().feedSection,children:[(0,a.jsxs)("div",{className:i().feedTitle,children:[a.jsx("h2",{children:"Recent Bathroom Updates"}),a.jsx("button",{onClick:()=>L(!0),disabled:C,children:C?"Loading...":"Refresh"})]}),y&&a.jsx("div",{className:i().error,children:y}),C?(0,a.jsxs)("div",{className:i().loadingContainer,children:[a.jsx("div",{className:i().loader}),a.jsx("span",{children:"Loading feed..."})]}):a.jsx("div",{className:i().feedList,children:w.length>0?w.map(e=>a.jsx("div",{className:`${i().feedItem} ${S.has(e.id)?i().newFeedItem:""}`,children:(0,a.jsxs)("div",{className:i().content,children:[(0,a.jsxs)("div",{className:i().contentLeft,children:[a.jsx("span",{className:i().emoji,children:e.emoji}),(0,a.jsxs)("a",{href:`https://bsky.app/profile/${e.authorHandle}`,target:"_blank",rel:"noopener noreferrer",className:i().authorLink,children:["@",e.authorHandle]}),a.jsx("span",{className:i().text,children:e.text?e.text.length>60?`${e.text.substring(0,60)}...`:e.text:"is flushing"})]}),a.jsx("span",{className:i().timestamp,children:new Date(e.createdAt).toLocaleString()})]})},e.id)):a.jsx("div",{className:i().emptyState,children:a.jsx("p",{children:"No entries found. Be the first to share your status!"})})})]})]}):null}},47182:e=>{e.exports={container:"dashboard_container__Kdrrt",header:"dashboard_header__0IQ3E",userInfo:"dashboard_userInfo__J_gfr",actions:"dashboard_actions__c3bbO",feedButton:"dashboard_feedButton__GHwmr",logoutButton:"dashboard_logoutButton__YBR7L",card:"dashboard_card__uY0FF",description:"dashboard_description__SowcW",code:"dashboard_code__Twdmp",error:"dashboard_error__ih3px",success:"dashboard_success__yQeDz",form:"dashboard_form__2eBG3",formGroup:"dashboard_formGroup__xr6t0",statusUpdateContainer:"dashboard_statusUpdateContainer__8qgXn",statusUpdateOpen:"dashboard_statusUpdateOpen__cjWN2",toggleButton:"dashboard_toggleButton__A8QTo",toggleButtonActive:"dashboard_toggleButtonActive__xa96Q",input:"dashboard_input__5d_PV",charCount:"dashboard_charCount__VcNH8",emojiGrid:"dashboard_emojiGrid__1QgTK",emojiButton:"dashboard_emojiButton__NHK3w",selectedEmoji:"dashboard_selectedEmoji__7uk_7",preview:"dashboard_preview__oDbiu",previewTitle:"dashboard_previewTitle__my2eH",previewContent:"dashboard_previewContent__tEi9N",previewEmoji:"dashboard_previewEmoji__Y7zWA",submitButton:"dashboard_submitButton__SX1H6",feedSection:"dashboard_feedSection__ithG1",feedTitle:"dashboard_feedTitle__mw_DG",backButton:"dashboard_backButton__Fw6c0",feedList:"dashboard_feedList__rOyRk",feedItem:"dashboard_feedItem__vNBE0",feedHeader:"dashboard_feedHeader__OWx0_",authorLink:"dashboard_authorLink__RO_y9",timestamp:"dashboard_timestamp__ZHT5q",content:"dashboard_content__lgdH3",contentLeft:"dashboard_contentLeft__Ppg07",emoji:"dashboard_emoji__grbmJ",newFeedItem:"dashboard_newFeedItem__ffo7b",slideIn:"dashboard_slideIn__K8cik",text:"dashboard_text___6pcW",loadingContainer:"dashboard_loadingContainer__DQmdc",loader:"dashboard_loader__KY9QC",spin:"dashboard_spin__HizU5"}},38256:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(68570).createProxy)(String.raw`/Users/dame/Library/Mobile Documents/com~apple~CloudDocs/Software/flushes/app/src/app/dashboard/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[276,659,568],()=>s(50876));module.exports=a})();